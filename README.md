# LSTM 股票趨勢預測模型

## 項目概述
本專案嘗試使用 LSTM 深度學習模型，基於歷史股票數據（包括 K 線形態、技術指標以及市場情緒指標）來預測未來股價趨勢。模型將預測結果劃分為三個類別：
- **2：上漲趨勢**（5日HPR > 3%）
- **0：下跌趨勢**（5日HPR < -3%）
- **1：盤整/趨勢不明**（-3% ≤ 5日HPR ≤ 3%）

## 資料特徵

### K 線形態特徵
- **Pct_Change**：價格變動百分比
- **upper_shadow_ratio**：上影線比例  
  計算公式：  
  `(最高價 - max(開盤價, 收盤價)) / (最高價 - 最低價)`
- **lower_shadow_ratio**：下影線比例  
  計算公式：  
  `(min(開盤價, 收盤價) - 最低價) / (最高價 - 最低價)`
- **price_diff_ratio**：價格變動率  
  計算公式：  
  `(收盤價 - 開盤價) / 開盤價`
  
  ### 技術指標
- **Vol_Pct_Change**：成交量變動百分比
- **RSI_7** & **RSI_14**：相對強弱指標（7日與14日）
- **DIF、DEA、MACD**：指數平滑異同移動平均線指標

### 市場情緒指標
- **VIX**：恐慌指數

## 模型架構

- 輸入：30天歷史資料序列（11個特徵）

- LSTM層：64個隱藏單元

- 正規化：30% Dropout

- 輸出：三分類機率分佈（上漲/下跌/盤整）

## 模型效果分析
  
儘管模型在訓練集上可以達到一定準確率（約70-80%），但在測試集上表現不佳，主要原因如下：

1. 有效市場假說（EMH）的挑戰
市場效率性：股票價格已反映所有可用信息，技術指標無法提供超額收益

隨機遊走：短期價格變動近似隨機過程，難以預測

模型表現：測試集準確率接近隨機猜測（約33%），表示模型未學習到有效模式

2. 市場主導因素不匹配
宏觀經濟主導：利率、通膨、GDP等宏觀因素影響超過技術指標

突發事件驅動：財報發布、政策變動等地緣政治事件主導短期波動

市場情緒複雜度：VIX等情緒指標與價格非簡單線性關係
