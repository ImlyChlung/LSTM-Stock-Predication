# LSTM 股票趨勢預測模型

## 項目概述
本專案嘗試使用 LSTM 深度學習模型，基於歷史股票數據（包括 K 線形態、技術指標以及市場情緒指標）來預測未來股價趨勢。模型將預測結果劃分為三個類別：
- **2：上漲趨勢**（5日HPR > 3%）
- **0：下跌趨勢**（5日HPR < -3%）
- **1：盤整/趨勢不明**（-3% ≤ 5日HPR ≤ 3%）

## 資料特徵

### K 線形態特徵
- **Pct_Change**：價格變動百分比
- **upper_shadow_ratio**：上影線比例  
  計算公式：  
  `(最高價 - max(開盤價, 收盤價)) / (最高價 - 最低價)`
- **lower_shadow_ratio**：下影線比例  
  計算公式：  
  `(min(開盤價, 收盤價) - 最低價) / (最高價 - 最低價)`
- **price_diff_ratio**：價格變動率  
  計算公式：  
  `(收盤價 - 開盤價) / 開盤價`
  
  ### 技術指標
- **Vol_Pct_Change**：成交量變動百分比
- **RSI_7** & **RSI_14**：相對強弱指標（7日與14日）
- **DIF、DEA、MACD**：指數平滑異同移動平均線指標

### 市場情緒指標
- **VIX**：恐慌指數

## 模型架構

- 輸入：30天歷史資料序列（11個特徵）

- LSTM層：2層LSTM，64個隱藏單元

- 正規化：30% Dropout

- 輸出：三分類機率分佈（上漲/下跌/盤整）

## 模型效果分析

儘管模型在訓練集上能夠達到約 70-80% 的準確率，但在測試集上的表現明顯不如預期，這主要體現了以下三個核心挑戰：

1. **有效市場假說（EMH）的挑戰**
   
   - **市場效率性**：根據有效市場假說，所有可用信息已經反映在股票價格中，因此僅依靠技術指標往往難以捕捉到超額收益。
   - **隨機遊走特性**：短期價格變動近似隨機過程，使得未來趨勢難以預測。  
   - **模型表現**：測試集準確率約52-56%，說明模型未能學習到有效的市場模式，預測效果接近隨機猜測。

2. **市場主導因素不匹配**

   - **宏觀經濟影響**：諸如利率、通膨、GDP 等宏觀經濟因素對股票價格的影響往往超過純技術指標所反映的信息。  
   - **突發事件驅動**：財報發布、政策變動及其他地緣政治事件常常主導短期內的價格波動，這部分信息往往難以通過歷史數據加以捕捉。  
   - **市場情緒複雜性**：例如 VIX 等市場情緒指標與價格之間並非簡單的線性關係，使得模型難以從中提煉出穩定有效的預測信號。

3. **市場操縱與數據局限**

   - **噪音主導訊號**：技術指標訊號被市場雜訊淹沒。
   - **大單操弄**：機構大單交易導致有時候技術形態失真


綜上所述，雖然模型具備一定的理論預測能力，但由於受到市場內在複雜性和外部因素的影響，其實際應用效果仍有待進一步提升。

## 安裝

```
pip install pandas numpy matplotlib scikit-learn torch tqdm
```
